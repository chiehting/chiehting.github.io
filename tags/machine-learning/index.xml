<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>machine-learning on Chiehting</title><link>https://chiehting.com/tags/machine-learning/</link><description>Recent content in machine-learning on Chiehting</description><generator>Hugo -- gohugo.io</generator><copyright>Copyright © 2008–2018, Steve Francia and the Hugo Authors; all rights reserved.</copyright><lastBuildDate>Sun, 18 May 2025 23:28:07 +0800</lastBuildDate><atom:link href="https://chiehting.com/tags/machine-learning/index.xml" rel="self" type="application/rss+xml"/><item><title>使用 coco 2017 dataset 做 yolo11 訓練</title><link>https://chiehting.com/posts/yolo-with-coco-dataset/</link><pubDate>Sun, 18 May 2025 23:28:07 +0800</pubDate><guid>https://chiehting.com/posts/yolo-with-coco-dataset/</guid><description>
&lt;h2 id="使用-coco-2017-dataset-訓練-yolo11">使用 COCO 2017 Dataset 訓練 YOLO11&lt;/h2>
&lt;h3 id="專案流程總覽">專案流程總覽&lt;/h3>
&lt;p>&lt;a href="https://github.com/chiehting/yolo-with-coco-dataset">github: yolo-with-coco-dataset&lt;/a>&lt;/p>
&lt;ol>
&lt;li>
&lt;p>&lt;strong>資料集準備&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>從 COCO 官方網站下載 2017 年版的訓練集、驗證集圖片及標註檔案。&lt;/li>
&lt;li>將資料分別放在 &lt;code>coco2017/annotations&lt;/code>、&lt;code>coco2017/train2017&lt;/code>、&lt;code>coco2017/val2017&lt;/code> 目錄下。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>資料格式轉換&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>使用 &lt;code>1_convert_to_yolo11.py&lt;/code> 進行 COCO → YOLO 格式轉換，並可過濾所需的類別（categories）。&lt;/li>
&lt;li>COCO bbox 格式為 &lt;code>[x_min, y_min, width, height]&lt;/code>，需轉成 YOLO 格式 &lt;code>[class_id, x_center, y_center, width, height]&lt;/code>，且所有值需歸一化到 [0, 1]。&lt;/li>
&lt;li>需自行設計類別對應（category mapping）。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>訓練流程&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>執行 &lt;code>2_train.py&lt;/code> 進行模型訓練。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;strong>推論預測&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>執行 &lt;code>3_predict.py&lt;/code> 進行圖片預測。&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="1-準備資料集">1. 準備資料集&lt;/h3>
&lt;p>這是最關鍵的步驟之一：&lt;/p>
&lt;ul>
&lt;li>&lt;strong>收集圖片&lt;/strong>：收集包含您想要偵測物件的圖片&lt;/li>
&lt;li>&lt;strong>標註資料&lt;/strong>：為每張圖片中的目標物件創建標註（邊界框和類別）&lt;/li>
&lt;li>&lt;strong>資料集分割&lt;/strong>：將資料集分為訓練集、驗證集和測試集（通常比例為 70%/20%/10%）&lt;/li>
&lt;/ul>
&lt;p>YOLO 格式&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-txt" data-lang="txt">&lt;span class="line">&lt;span class="ln">1&lt;/span>&lt;span class="cl">&amp;lt;class_id&amp;gt; &amp;lt;x_center&amp;gt; &amp;lt;y_center&amp;gt; &amp;lt;width&amp;gt; &amp;lt;height&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>COCO 的邊界框格式 &lt;code>[x_min, y_min, width, height]&lt;/code> 轉換為 YOLO 的 &lt;code>[x_center, y_center, width, height]&lt;/code> 格式&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="ln"> 1&lt;/span>&lt;span class="cl">&lt;span class="c1"># COCO 格式邊界框&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 2&lt;/span>&lt;span class="cl">&lt;span class="n">x_min&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">433.61&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 3&lt;/span>&lt;span class="cl">&lt;span class="n">y_min&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">213.88&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 4&lt;/span>&lt;span class="cl">&lt;span class="n">width&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">39.67&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 5&lt;/span>&lt;span class="cl">&lt;span class="n">height&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mf">112.56&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 6&lt;/span>&lt;span class="cl">&lt;span class="n">category_id&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">16&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 7&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 8&lt;/span>&lt;span class="cl">&lt;span class="c1"># 圖片尺寸&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 9&lt;/span>&lt;span class="cl">&lt;span class="n">image_width&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">640&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">10&lt;/span>&lt;span class="cl">&lt;span class="n">image_height&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">480&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">11&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">12&lt;/span>&lt;span class="cl">&lt;span class="c1"># 計算 YOLO 格式的中心點座標&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">13&lt;/span>&lt;span class="cl">&lt;span class="n">x_center&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">x_min&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">width&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">image_width&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">14&lt;/span>&lt;span class="cl">&lt;span class="n">y_center&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">(&lt;/span>&lt;span class="n">y_min&lt;/span> &lt;span class="o">+&lt;/span> &lt;span class="n">height&lt;/span>&lt;span class="o">/&lt;/span>&lt;span class="mi">2&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">image_height&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">15&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">16&lt;/span>&lt;span class="cl">&lt;span class="c1"># 計算 YOLO 格式的寬高（歸一化）&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">17&lt;/span>&lt;span class="cl">&lt;span class="n">yolo_width&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">width&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">image_width&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">18&lt;/span>&lt;span class="cl">&lt;span class="n">yolo_height&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="n">height&lt;/span> &lt;span class="o">/&lt;/span> &lt;span class="n">image_height&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">19&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">20&lt;/span>&lt;span class="cl">&lt;span class="c1"># 假設我們將 COCO 類別 ID 16 映射到 YOLO 類別 ID 5&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">21&lt;/span>&lt;span class="cl">&lt;span class="n">yolo_class_id&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="mi">5&lt;/span> &lt;span class="c1"># 這取決於您的類別映射&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">22&lt;/span>&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">23&lt;/span>&lt;span class="cl">&lt;span class="c1"># 生成 YOLO 格式的字串&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">24&lt;/span>&lt;span class="cl">&lt;span class="n">yolo_format&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="sa">f&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">yolo_class_id&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">x_center&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.6f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">y_center&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.6f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">yolo_width&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.6f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2"> &lt;/span>&lt;span class="si">{&lt;/span>&lt;span class="n">yolo_height&lt;/span>&lt;span class="si">:&lt;/span>&lt;span class="s2">.6f&lt;/span>&lt;span class="si">}&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">25&lt;/span>&lt;span class="cl">&lt;span class="nb">print&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">yolo_format&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description></item></channel></rss>