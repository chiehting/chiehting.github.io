<!doctype html><html lang=en-us><head><script async src="https://www.googletagmanager.com/gtag/js?id=G-G1C48BPHVP"></script><script>var dnt,doNotTrack=!1;if(!1&&(dnt=navigator.doNotTrack||window.doNotTrack||navigator.msDoNotTrack,doNotTrack=dnt=="1"||dnt=="yes"),!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-G1C48BPHVP")}</script><meta charset=UTF-8><meta charset=utf-8><meta name=viewport content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimal-ui"><meta http-equiv=X-UA-Compatible content="ie=edge"><meta name=robots content="index, follow"><meta name=author content><meta name=description content="This website is preview about Chiehting. irregular update."><link rel=manifest href=/site.webmanifest><link rel=icon type=image/png sizes=96x96 href=/favicon-96x96.png><link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><meta name=apple-mobile-web-app-title content="Chiehting's Blog"><meta name=theme-color content="#494f5c"><meta name=msapplication-TileColor content="#494f5c"><meta itemprop=name content="Linux kernel 的網路參數 rp_filter"><meta itemprop=description content="這篇來記錄有關 Linux kernel 的 network 參數。"><meta itemprop=datePublished content="2021-06-24T14:39:00+08:00"><meta itemprop=dateModified content="2021-06-24T14:39:00+08:00"><meta itemprop=wordCount content="1535"><meta itemprop=keywords content="Linux,Network"><meta property="og:url" content="https://chiehting.com/posts/linux-kernel-rp-filter/"><meta property="og:site_name" content="Chiehting's Blog"><meta property="og:title" content="Linux kernel 的網路參數 rp_filter"><meta property="og:description" content="這篇來記錄有關 Linux kernel 的 network 參數。"><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-06-24T14:39:00+08:00"><meta property="article:modified_time" content="2021-06-24T14:39:00+08:00"><meta property="article:tag" content="Linux"><meta property="article:tag" content="Network"><meta name=twitter:card content="summary"><meta name=twitter:title content="Linux kernel 的網路參數 rp_filter"><meta name=twitter:description content="這篇來記錄有關 Linux kernel 的 network 參數。"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Linux kernel 的網路參數 rp_filter","name":"Linux kernel 的網路參數 rp_filter","description":"這篇來記錄有關 Linux kernel 的 network 參數。\n","keywords":["linux","network"],"articleBody":"這篇來記錄有關 Linux kernel 的 network 參數。\nReferences ip-sysctl\nrp_filter 為逆向路徑過濾 (Reverse Path Filtering)，其作用為為過濾反向不通的封包，將其丟棄。 而原理為由 NIC1 (network interface card) 進來的封包，reverse path filtering 模塊會將其封包的源地址（source ip）與目標地址（destination ip）做對調，然後再路由表中查找，如果出去的介面是 NIC1 則通過；反之不是 NIC1 則丟棄該封包。\n功能概述 rp_filter 的主要作用是檢查接收到的資料包的來源位址是否是通過正確的網路介面到達的。如果資料包的來源位址與路由表中的反向路徑不匹配，rp_filter 就會丟棄該資料包，從而防止偽造的 IP 資料包進入系統。\n工作原理 當系統接收到一個資料包時，rp_filter 會檢查該資料包的來源位址。 它根據路由表計算，若系統要將一個資料包發送到該來源位址，會使用哪個網路介面。 如果接收到的資料包實際上是通過另一個介面到達的，而不是路由表中計算出的介面，rp_filter 會認為這個資料包是偽造的，並將其丟棄。 可以從 ip-sysctl 文件中找到參數的用法。其中該參數為整數型，其值包括了 0：不做來源驗證；1：嚴謹認證模式；2：寬鬆認證模式。\nrp_filter - INTEGER 0 - No source validation. 1 - Strict mode as defined in RFC3704 Strict Reverse Path Each incoming packet is tested against the FIB and if the interface is not the best reverse path the packet check will fail. By default failed packets are discarded. 2 - Loose mode as defined in RFC3704 Loose Reverse Path Each incoming packet's source address is also tested against the FIB and if the source address is not reachable via any interface the packet check will fail. Current recommended practice in RFC3704 is to enable strict mode to prevent IP spoofing from DDos attacks. If using asymmetric routing or other complicated routing, then loose mode is recommended. The max value from conf/{all,interface}/rp_filter is used when doing source validation on the {interface}. Default value is 0. Note that some distributions enable it in startup scripts. Source code 可以上網找到原始碼 fib_frontend.c，這邊來看一下實作方法。\n/* Ignore rp_filter for packets protected by IPsec. */ int fib_validate_source(struct sk_buff *skb, __be32 src, __be32 dst, u8 tos, int oif, struct net_device *dev, struct in_device *idev, u32 *itag) { /* 是否啟用反向封包過濾功能，這邊注意如果封包受 IPSec 保護則忽略反向封包過濾功能 */ int r = secpath_exists(skb) ? 0 : IN_DEV_RPFILTER(idev); struct net *net = dev_net(dev); if (!r \u0026\u0026 !fib_num_tclassid_users(net) \u0026\u0026 (dev-\u003eifindex != oif || !IN_DEV_TX_REDIRECTS(idev))) { /* 本地源的封包不執行反向封包過濾功能 */ if (IN_DEV_ACCEPT_LOCAL(idev)) goto ok; /* with custom local routes in place, checking local addresses * only will be too optimistic, with custom rules, checking * local addresses only can be too strict, e.g. due to vrf */ if (net-\u003eipv4.fib_has_custom_local_routes || fib4_has_custom_rules(net)) goto full_check; if (inet_lookup_ifaddr_rcu(net, src)) return -EINVAL; ok: *itag = 0; return 0; } full_check: return __fib_validate_source(skb, src, dst, tos, oif, dev, r, idev, itag); } static int __fib_validate_source(struct sk_buff *skb, __be32 src, __be32 dst, u8 tos, int oif, struct net_device *dev, int rpf, struct in_device *idev, u32 *itag) { struct net *net = dev_net(dev); struct flow_keys flkeys; int ret, no_addr; struct fib_result res; struct flowi4 fl4; bool dev_match; fl4.flowi4_oif = 0; fl4.flowi4_iif = l3mdev_master_ifindex_rcu(dev); if (!fl4.flowi4_iif) fl4.flowi4_iif = oif ? : LOOPBACK_IFINDEX; /* 可以看到這邊做反轉了 */ fl4.daddr = src; fl4.saddr = dst; fl4.flowi4_tos = tos; fl4.flowi4_scope = RT_SCOPE_UNIVERSE; fl4.flowi4_tun_key.tun_id = 0; fl4.flowi4_flags = 0; fl4.flowi4_uid = sock_net_uid(net, NULL); fl4.flowi4_multipath_hash = 0; no_addr = idev-\u003eifa_list == NULL; fl4.flowi4_mark = IN_DEV_SRC_VMARK(idev) ? skb-\u003emark : 0; if (!fib4_rules_early_flow_dissect(net, skb, \u0026fl4, \u0026flkeys)) { fl4.flowi4_proto = 0; fl4.fl4_sport = 0; fl4.fl4_dport = 0; } if (fib_lookup(net, \u0026fl4, \u0026res, 0)) goto last_resort; if (res.type != RTN_UNICAST \u0026\u0026 (res.type != RTN_LOCAL || !IN_DEV_ACCEPT_LOCAL(idev))) goto e_inval; fib_combine_itag(itag, \u0026res); dev_match = fib_info_nh_uses_dev(res.fi, dev); /* This is not common, loopback packets retain skb_dst so normally they * would not even hit this slow path. */ dev_match = dev_match || (res.type == RTN_LOCAL \u0026\u0026 dev == net-\u003eloopback_dev); if (dev_match) { ret = FIB_RES_NHC(res)-\u003enhc_scope \u003e= RT_SCOPE_HOST; return ret; } if (no_addr) goto last_resort; if (rpf == 1) goto e_rpf; fl4.flowi4_oif = dev-\u003eifindex; ret = 0; if (fib_lookup(net, \u0026fl4, \u0026res, FIB_LOOKUP_IGNORE_LINKSTATE) == 0) { if (res.type == RTN_UNICAST) ret = FIB_RES_NHC(res)-\u003enhc_scope \u003e= RT_SCOPE_HOST; } return ret; last_resort: if (rpf) goto e_rpf; *itag = 0; return 0; e_inval: return -EINVAL; e_rpf: return -EXDEV; } 參數：\nstruct sk_buff - socket buffer __be32 src - source __be32 dst - destination struct net_device - 網路結構體 struct in_device - 網路結構體 saddr - start address daddr - destination address 科普：\n__bet32 - le 與 be 分別表示 little endian 和 big endian u8、u32 - 表示無符號 char 字符類型 作用 當前RFC3704文檔建議使用嚴謹認證模式。如果網路是非對稱網路或複雜的網路 rp_filter 建議配置為 2，做寬鬆認證。 而 rp_filter 配置作用通常為下列：\n減少 DDoS 攻擊，注意是減少不是防止 防止 IP Spoofing 問題 當系統只有一個網路介面時，是否需要開啟 rp_filter 取決於具體的需求和安全性考量。 只有一個網路介面，且無特殊路由需求\n如果系統只有一個網路介面，且路由配置相對簡單（例如，所有流量都通過該介面進出），那麼來源 IP 位址欺騙的風險較低。 在這種情況下，開啟 rp_filter 的作用有限，因為所有資料包都只能通過這唯一的網路介面進出。 只有一個網路介面，但存在潛在的安全威脅\n即使系統只有一個網路介面，攻擊者仍可能試圖通過偽造來源 IP 位址向系統發送惡意資料包。 開啟 rp_filter 可以增加一層安全性，確保接收到的資料包符合路由規則，從而防止這類攻擊。 未來可能擴展到多網路介面\n如果系統未來可能會增加更多網路介面，建議養成良好的安全習慣，提前配置 rp_filter，以避免多介面時的安全漏洞。 ","wordCount":"1535","inLanguage":"en","datePublished":"2021-06-24T14:39:00+08:00","dateModified":"2021-06-24T14:39:00+08:00","author":{"@type":"Person","name":null},"mainEntityOfPage":{"@type":"WebPage","@id":"https://chiehting.com/posts/linux-kernel-rp-filter/"},"publisher":{"@type":"Organization","name":"Chiehting's Blog","description":"This website is preview about Chiehting. irregular update.","logo":{"@type":"ImageObject","url":"https://chiehting.com/favicon.ico"}}}</script><title>Linux kernel 的網路參數 rp_filter</title><link rel="stylesheet dns-prefetch preconnect preload prefetch" as=style media=screen href=https://chiehting.com/css/style.min.4a728eca217aff37d24d94ea492de99e69fea0a53bb05c836db76b9d0504ef60.css integrity="sha256-SnKOyiF6/zfSTZTqSS3pnmn+oKU7sFyDbbdrnQUE72A=" crossorigin=anonymous></head><body id=page><header id=site-header class="animated slideInUp"><div class="hdr-wrapper section-inner"><div class=hdr-left><div class=site-branding><a href=https://chiehting.com/>Chiehting's Blog</a></div><nav class="site-nav hide-in-mobile"><a href=https://chiehting.com/posts/>Posts</a><a href=https://chiehting.com/about/>About</a></nav></div><div class="hdr-right hdr-icons"><span class="hdr-links hide-in-mobile"><a href=ting911111@gmail.com target=_blank rel="noopener me" title=Email><svg class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1.0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1.0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg></a><a href=https://github.com/chiehting target=_blank rel="noopener me" title=Github><svg class="feather" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37.0 00-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44.0 0020 4.77 5.07 5.07.0 0019.91 1S18.73.65 16 2.48a13.38 13.38.0 00-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07.0 005 4.77 5.44 5.44.0 003.5 8.55c0 5.42 3.3 6.61 6.44 7A3.37 3.37.0 009 18.13V22"/></svg></a></span><button id=menu-btn class=hdr-btn title=Menu><svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-menu"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg></button></div></div></header><div id=mobile-menu class="animated fast"><ul><li><a href=https://chiehting.com/posts/>Posts</a></li><li><a href=https://chiehting.com/about/>About</a></li></ul></div><main class="site-main section-inner thin animated fadeIn faster"><h1>Linux kernel 的網路參數 rp_filter</h1><div class=content><p>這篇來記錄有關 Linux kernel 的 network 參數。</p><h3 id=references>References<a href=#references class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p><a href=https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt>ip-sysctl</a></p><h3 id=rp_filter>rp_filter<a href=#rp_filter class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><p>為逆向路徑過濾 (Reverse Path Filtering)，其作用為為過濾反向不通的封包，將其丟棄。
而原理為由 NIC1 (network interface card) 進來的封包，reverse path filtering 模塊會將其封包的源地址（source ip）與目標地址（destination ip）做對調，然後再路由表中查找，如果出去的介面是 NIC1 則通過；反之不是 NIC1 則丟棄該封包。</p><h4 id=功能概述>功能概述<a href=#%e5%8a%9f%e8%83%bd%e6%a6%82%e8%bf%b0 class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><p><code>rp_filter</code> 的主要作用是檢查接收到的資料包的來源位址是否是通過正確的網路介面到達的。如果資料包的來源位址與路由表中的反向路徑不匹配，<code>rp_filter</code> 就會丟棄該資料包，從而防止偽造的 IP 資料包進入系統。</p><h3 id=工作原理>工作原理<a href=#%e5%b7%a5%e4%bd%9c%e5%8e%9f%e7%90%86 class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><ol><li>當系統接收到一個資料包時，<code>rp_filter</code> 會檢查該資料包的來源位址。</li><li>它根據路由表計算，若系統要將一個資料包發送到該來源位址，會使用哪個網路介面。</li><li>如果接收到的資料包實際上是通過另一個介面到達的，而不是路由表中計算出的介面，<code>rp_filter</code> 會認為這個資料包是偽造的，並將其丟棄。</li></ol><p>可以從 <a href=https://www.kernel.org/doc/Documentation/networking/ip-sysctl.txt>ip-sysctl</a> 文件中找到參數的用法。其中該參數為整數型，其值包括了 0：不做來源驗證；1：嚴謹認證模式；2：寬鬆認證模式。</p><pre><code>rp_filter - INTEGER
    0 - No source validation.
    1 - Strict mode as defined in RFC3704 Strict Reverse Path
        Each incoming packet is tested against the FIB and if the interface
        is not the best reverse path the packet check will fail.
        By default failed packets are discarded.
    2 - Loose mode as defined in RFC3704 Loose Reverse Path
        Each incoming packet's source address is also tested against the FIB
        and if the source address is not reachable via any interface
        the packet check will fail.

Current recommended practice in RFC3704 is to enable strict mode
    to prevent IP spoofing from DDos attacks. If using asymmetric routing
    or other complicated routing, then loose mode is recommended.

The max value from conf/{all,interface}/rp_filter is used
    when doing source validation on the {interface}.

Default value is 0. Note that some distributions enable it
    in startup scripts.
</code></pre><h4 id=source-code>Source code<a href=#source-code class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><p>可以上網找到原始碼 <a href=https://elixir.bootlin.com/linux/latest/source/net/ipv4/fib_frontend.c#L419>fib_frontend.c</a>，這邊來看一下實作方法。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=cm>/* Ignore rp_filter for packets protected by IPsec. */</span>
</span></span><span class=line><span class=cl><span class=kt>int</span> <span class=nf>fib_validate_source</span><span class=p>(</span><span class=k>struct</span> <span class=n>sk_buff</span> <span class=o>*</span><span class=n>skb</span><span class=p>,</span> <span class=n>__be32</span> <span class=n>src</span><span class=p>,</span> <span class=n>__be32</span> <span class=n>dst</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=n>u8</span> <span class=n>tos</span><span class=p>,</span> <span class=kt>int</span> <span class=n>oif</span><span class=p>,</span> <span class=k>struct</span> <span class=n>net_device</span> <span class=o>*</span><span class=n>dev</span><span class=p>,</span>
</span></span><span class=line><span class=cl>            <span class=k>struct</span> <span class=n>in_device</span> <span class=o>*</span><span class=n>idev</span><span class=p>,</span> <span class=n>u32</span> <span class=o>*</span><span class=n>itag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* 是否啟用反向封包過濾功能，這邊注意如果封包受 IPSec 保護則忽略反向封包過濾功能 */</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>r</span> <span class=o>=</span> <span class=nf>secpath_exists</span><span class=p>(</span><span class=n>skb</span><span class=p>)</span> <span class=o>?</span> <span class=mi>0</span> <span class=o>:</span> <span class=nf>IN_DEV_RPFILTER</span><span class=p>(</span><span class=n>idev</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>struct</span> <span class=n>net</span> <span class=o>*</span><span class=n>net</span> <span class=o>=</span> <span class=nf>dev_net</span><span class=p>(</span><span class=n>dev</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>r</span> <span class=o>&amp;&amp;</span> <span class=o>!</span><span class=nf>fib_num_tclassid_users</span><span class=p>(</span><span class=n>net</span><span class=p>)</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=n>dev</span><span class=o>-&gt;</span><span class=n>ifindex</span> <span class=o>!=</span> <span class=n>oif</span> <span class=o>||</span> <span class=o>!</span><span class=nf>IN_DEV_TX_REDIRECTS</span><span class=p>(</span><span class=n>idev</span><span class=p>)))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=cm>/* 本地源的封包不執行反向封包過濾功能 */</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nf>IN_DEV_ACCEPT_LOCAL</span><span class=p>(</span><span class=n>idev</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>goto</span> <span class=n>ok</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=cm>/* with custom local routes in place, checking local addresses
</span></span></span><span class=line><span class=cl><span class=cm>        * only will be too optimistic, with custom rules, checking
</span></span></span><span class=line><span class=cl><span class=cm>        * local addresses only can be too strict, e.g. due to vrf
</span></span></span><span class=line><span class=cl><span class=cm>        */</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>net</span><span class=o>-&gt;</span><span class=n>ipv4</span><span class=p>.</span><span class=n>fib_has_custom_local_routes</span> <span class=o>||</span>
</span></span><span class=line><span class=cl>            <span class=nf>fib4_has_custom_rules</span><span class=p>(</span><span class=n>net</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>goto</span> <span class=n>full_check</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=nf>inet_lookup_ifaddr_rcu</span><span class=p>(</span><span class=n>net</span><span class=p>,</span> <span class=n>src</span><span class=p>))</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=o>-</span><span class=n>EINVAL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>ok</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=o>*</span><span class=n>itag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>full_check</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=nf>__fib_validate_source</span><span class=p>(</span><span class=n>skb</span><span class=p>,</span> <span class=n>src</span><span class=p>,</span> <span class=n>dst</span><span class=p>,</span> <span class=n>tos</span><span class=p>,</span> <span class=n>oif</span><span class=p>,</span> <span class=n>dev</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>idev</span><span class=p>,</span> <span class=n>itag</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-c data-lang=c><span class=line><span class=cl><span class=k>static</span> <span class=kt>int</span> <span class=nf>__fib_validate_source</span><span class=p>(</span><span class=k>struct</span> <span class=n>sk_buff</span> <span class=o>*</span><span class=n>skb</span><span class=p>,</span> <span class=n>__be32</span> <span class=n>src</span><span class=p>,</span> <span class=n>__be32</span> <span class=n>dst</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=n>u8</span> <span class=n>tos</span><span class=p>,</span> <span class=kt>int</span> <span class=n>oif</span><span class=p>,</span> <span class=k>struct</span> <span class=n>net_device</span> <span class=o>*</span><span class=n>dev</span><span class=p>,</span>
</span></span><span class=line><span class=cl>                <span class=kt>int</span> <span class=n>rpf</span><span class=p>,</span> <span class=k>struct</span> <span class=n>in_device</span> <span class=o>*</span><span class=n>idev</span><span class=p>,</span> <span class=n>u32</span> <span class=o>*</span><span class=n>itag</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=k>struct</span> <span class=n>net</span> <span class=o>*</span><span class=n>net</span> <span class=o>=</span> <span class=nf>dev_net</span><span class=p>(</span><span class=n>dev</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>struct</span> <span class=n>flow_keys</span> <span class=n>flkeys</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>int</span> <span class=n>ret</span><span class=p>,</span> <span class=n>no_addr</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>struct</span> <span class=n>fib_result</span> <span class=n>res</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>struct</span> <span class=n>flowi4</span> <span class=n>fl4</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kt>bool</span> <span class=n>dev_match</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_oif</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_iif</span> <span class=o>=</span> <span class=nf>l3mdev_master_ifindex_rcu</span><span class=p>(</span><span class=n>dev</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_iif</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_iif</span> <span class=o>=</span> <span class=n>oif</span> <span class=o>?</span> <span class=o>:</span> <span class=n>LOOPBACK_IFINDEX</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* 可以看到這邊做反轉了 */</span>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>daddr</span> <span class=o>=</span> <span class=n>src</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>saddr</span> <span class=o>=</span> <span class=n>dst</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_tos</span> <span class=o>=</span> <span class=n>tos</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_scope</span> <span class=o>=</span> <span class=n>RT_SCOPE_UNIVERSE</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_tun_key</span><span class=p>.</span><span class=n>tun_id</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_flags</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_uid</span> <span class=o>=</span> <span class=nf>sock_net_uid</span><span class=p>(</span><span class=n>net</span><span class=p>,</span> <span class=nb>NULL</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_multipath_hash</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>no_addr</span> <span class=o>=</span> <span class=n>idev</span><span class=o>-&gt;</span><span class=n>ifa_list</span> <span class=o>==</span> <span class=nb>NULL</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_mark</span> <span class=o>=</span> <span class=nf>IN_DEV_SRC_VMARK</span><span class=p>(</span><span class=n>idev</span><span class=p>)</span> <span class=o>?</span> <span class=n>skb</span><span class=o>-&gt;</span><span class=nl>mark</span> <span class=p>:</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=o>!</span><span class=nf>fib4_rules_early_flow_dissect</span><span class=p>(</span><span class=n>net</span><span class=p>,</span> <span class=n>skb</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>fl4</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>flkeys</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_proto</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>fl4</span><span class=p>.</span><span class=n>fl4_sport</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=n>fl4</span><span class=p>.</span><span class=n>fl4_dport</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>fib_lookup</span><span class=p>(</span><span class=n>net</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>fl4</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>res</span><span class=p>,</span> <span class=mi>0</span><span class=p>))</span>
</span></span><span class=line><span class=cl>        <span class=k>goto</span> <span class=n>last_resort</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>res</span><span class=p>.</span><span class=n>type</span> <span class=o>!=</span> <span class=n>RTN_UNICAST</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>        <span class=p>(</span><span class=n>res</span><span class=p>.</span><span class=n>type</span> <span class=o>!=</span> <span class=n>RTN_LOCAL</span> <span class=o>||</span> <span class=o>!</span><span class=nf>IN_DEV_ACCEPT_LOCAL</span><span class=p>(</span><span class=n>idev</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>        <span class=k>goto</span> <span class=n>e_inval</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=nf>fib_combine_itag</span><span class=p>(</span><span class=n>itag</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>res</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>dev_match</span> <span class=o>=</span> <span class=nf>fib_info_nh_uses_dev</span><span class=p>(</span><span class=n>res</span><span class=p>.</span><span class=n>fi</span><span class=p>,</span> <span class=n>dev</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=cm>/* This is not common, loopback packets retain skb_dst so normally they
</span></span></span><span class=line><span class=cl><span class=cm>    * would not even hit this slow path.
</span></span></span><span class=line><span class=cl><span class=cm>    */</span>
</span></span><span class=line><span class=cl>    <span class=n>dev_match</span> <span class=o>=</span> <span class=n>dev_match</span> <span class=o>||</span> <span class=p>(</span><span class=n>res</span><span class=p>.</span><span class=n>type</span> <span class=o>==</span> <span class=n>RTN_LOCAL</span> <span class=o>&amp;&amp;</span>
</span></span><span class=line><span class=cl>                <span class=n>dev</span> <span class=o>==</span> <span class=n>net</span><span class=o>-&gt;</span><span class=n>loopback_dev</span><span class=p>);</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>dev_match</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=n>ret</span> <span class=o>=</span> <span class=nf>FIB_RES_NHC</span><span class=p>(</span><span class=n>res</span><span class=p>)</span><span class=o>-&gt;</span><span class=n>nhc_scope</span> <span class=o>&gt;=</span> <span class=n>RT_SCOPE_HOST</span><span class=p>;</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>ret</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>no_addr</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>goto</span> <span class=n>last_resort</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>rpf</span> <span class=o>==</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>goto</span> <span class=n>e_rpf</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=n>fl4</span><span class=p>.</span><span class=n>flowi4_oif</span> <span class=o>=</span> <span class=n>dev</span><span class=o>-&gt;</span><span class=n>ifindex</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>ret</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=nf>fib_lookup</span><span class=p>(</span><span class=n>net</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>fl4</span><span class=p>,</span> <span class=o>&amp;</span><span class=n>res</span><span class=p>,</span> <span class=n>FIB_LOOKUP_IGNORE_LINKSTATE</span><span class=p>)</span> <span class=o>==</span> <span class=mi>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=p>(</span><span class=n>res</span><span class=p>.</span><span class=n>type</span> <span class=o>==</span> <span class=n>RTN_UNICAST</span><span class=p>)</span>
</span></span><span class=line><span class=cl>            <span class=n>ret</span> <span class=o>=</span> <span class=nf>FIB_RES_NHC</span><span class=p>(</span><span class=n>res</span><span class=p>)</span><span class=o>-&gt;</span><span class=n>nhc_scope</span> <span class=o>&gt;=</span> <span class=n>RT_SCOPE_HOST</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>ret</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>last_resort</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=p>(</span><span class=n>rpf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>goto</span> <span class=n>e_rpf</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=o>*</span><span class=n>itag</span> <span class=o>=</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nl>e_inval</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>-</span><span class=n>EINVAL</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=nl>e_rpf</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=o>-</span><span class=n>EXDEV</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>參數：</p><ul><li>struct sk_buff - socket buffer</li><li>__be32 src - source</li><li>__be32 dst - destination</li><li><a href=https://elixir.bootlin.com/linux/latest/source/include/linux/netdevice.h#L1853>struct net_device</a> - 網路結構體</li><li><a href=https://elixir.bootlin.com/linux/latest/source/include/linux/inetdevice.h#L25>struct in_device</a> - 網路結構體</li><li>saddr - start address</li><li>daddr - destination address</li></ul><p>科普：</p><ul><li>__bet32 - le 與 be 分別表示 little endian 和 big endian</li><li>u8、u32 - 表示無符號 char 字符類型</li></ul><h4 id=作用>作用<a href=#%e4%bd%9c%e7%94%a8 class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><p>當前RFC3704文檔建議使用嚴謹認證模式。如果網路是非對稱網路或複雜的網路 rp_filter 建議配置為 2，做寬鬆認證。
而 rp_filter 配置作用通常為下列：</p><ol><li>減少 DDoS 攻擊，注意是減少不是防止</li><li>防止 IP Spoofing</li></ol><h3 id=問題>問題<a href=#%e5%95%8f%e9%a1%8c class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h3><h4 id=當系統只有一個網路介面時是否需要開啟-rp_filter-取決於具體的需求和安全性考量>當系統只有一個網路介面時，是否需要開啟 <code>rp_filter</code> 取決於具體的需求和安全性考量。<a href=#%e7%95%b6%e7%b3%bb%e7%b5%b1%e5%8f%aa%e6%9c%89%e4%b8%80%e5%80%8b%e7%b6%b2%e8%b7%af%e4%bb%8b%e9%9d%a2%e6%99%82%e6%98%af%e5%90%a6%e9%9c%80%e8%a6%81%e9%96%8b%e5%95%9f-rp_filter-%e5%8f%96%e6%b1%ba%e6%96%bc%e5%85%b7%e9%ab%94%e7%9a%84%e9%9c%80%e6%b1%82%e5%92%8c%e5%ae%89%e5%85%a8%e6%80%a7%e8%80%83%e9%87%8f class=anchor aria-hidden=true><svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 7h3a5 5 0 015 5 5 5 0 01-5 5h-3m-6 0H6a5 5 0 01-5-5 5 5 0 015-5h3"/><line x1="8" y1="12" x2="16" y2="12"/></svg></a></h4><ol><li><p><strong>只有一個網路介面，且無特殊路由需求</strong></p><ul><li>如果系統只有一個網路介面，且路由配置相對簡單（例如，所有流量都通過該介面進出），那麼來源 IP 位址欺騙的風險較低。</li><li>在這種情況下，開啟 <code>rp_filter</code> 的作用有限，因為所有資料包都只能通過這唯一的網路介面進出。</li></ul></li><li><p><strong>只有一個網路介面，但存在潛在的安全威脅</strong></p><ul><li>即使系統只有一個網路介面，攻擊者仍可能試圖通過偽造來源 IP 位址向系統發送惡意資料包。</li><li>開啟 <code>rp_filter</code> 可以增加一層安全性，確保接收到的資料包符合路由規則，從而防止這類攻擊。</li></ul></li><li><p><strong>未來可能擴展到多網路介面</strong></p><ul><li>如果系統未來可能會增加更多網路介面，建議養成良好的安全習慣，提前配置 <code>rp_filter</code>，以避免多介面時的安全漏洞。</li></ul></li></ol></div><div class="human single"><a href=https://brainmade.org/ target=_blank rel="external noreferrer noopener"><abbr title="I don't hate AIs; but I love humans!"><svg fill="#fff" width="128" height="40" viewBox="0 0 128 40"><path d="M26.306 39.391H11.665a1.28 1.28.0 01-1.28-1.28v-3.838H6.399a1.28 1.28.0 01-1.28-1.28v-5.336l-4.41-2.198a1.28 1.28.0 01-.493-1.855l4.904-7.357v-2.175C5.12 6.298 11.422.0 19.194.0s14.073 6.3 14.075 14.071c-.316 13.912-5.38 11.758-5.59 17.023l-.093 7.018a1.3 1.3.0 01-.375.905 1.27 1.27.0 01-.905.375zm-13.361-2.559h12.082l.143-7.27c-.132-3.329 5.858-4.122 5.54-15.368-.179-6.356-5.157-11.635-11.515-11.635S7.68 7.713 7.679 14.071v2.559c-.001.253-.075.5-.215.71l-4.315 6.471 3.822 1.91a1.28 1.28.0 01.708 1.145v4.848h3.987a1.28 1.28.0 011.28 1.28z"/><path d="M20.186 29.111v-9.644c.059.0.118.009.177.009 4.885-.006 8.525-4.506 7.511-9.284a1.19 1.19.0 00-.911-.911 7.67 7.67.0 00-9.049 5.67l-.033-.036a7.66 7.66.0 00-7.03-2.085 1.19 1.19.0 00-.911.91c-1.014 4.777 2.627 9.277 7.51 9.284.118.0.246-.014.369-.02v6.106zm1.419-16.072a5.33 5.33.0 014.062-1.553 5.33 5.33.0 01-5.614 5.615 5.3 5.3.0 011.552-4.061zm-7.904 6.057a5.3 5.3.0 01-1.559-4.061 5.323 5.323.0 015.614 5.615 5.3 5.3.0 01-4.055-1.554m38.419-6.79q0 2.346-1.567 3.63-1.567 1.282-4.351 1.283h-7.669V0h7.016q2.807.0 4.242 1.1 1.446 1.087 1.446 3.226.0 1.467-.729 2.481-.718 1.002-2.197 1.357 1.86.244 2.828 1.32.979 1.063.979 2.823zm-4.112-7.491q0-1.161-.663-1.65-.652-.488-1.947-.488h-3.655v4.265h3.677q1.36.0 1.968-.525.62-.537.62-1.601m.892 7.209q0-2.42-3.089-2.42h-4.069v4.938h4.188q1.545.0 2.252-.624.718-.635.718-1.894m16.26 5.194-3.557-6.538h-3.764v6.538H54.63V0h7.658q2.741.0 4.231 1.332 1.49 1.32 1.49 3.8.0 1.808-.913 3.128-.914 1.308-2.47 1.723l4.144 7.235zm-.381-11.94q0-2.481-2.828-2.481h-4.112v5.083h4.199q1.349.0 2.045-.684.696-.685.696-1.919m16.785 11.94-1.36-4.399h-5.841l-1.359 4.399h-3.209L75.386.0h3.785l5.569 17.219zM77.278 2.651l-.066.269q-.109.44-.261 1.002c-.152.563-.725 2.436-1.871 6.184h4.405l-1.512-4.949-.468-1.662zm9.551 14.567V0h3.209v17.219zm15.53.0L95.681 3.959q.196 1.931.196 3.104v10.155h-2.849V0h3.666l6.777 13.37q-.196-1.846-.196-3.361V0h2.85v17.219zM52.63 39.375V28.331q.011-.351.115-3.015-.818 3.257-1.209 4.541l-2.925 9.518h-2.418l-2.925-9.518-1.232-4.541q.139 2.809.139 3.717v10.342h-3.017V22.313h4.548l2.902 9.543.253.92.553 2.289.725-2.736 2.983-10.015h4.526v17.063zm17.64.0-1.44-4.359h-6.184l-1.44 4.359h-3.397l5.919-17.063h4.007l5.896 17.063zm-4.537-14.434-.069.267q-.115.436-.277.993c-.162.557-.767 2.414-1.98 6.128h4.663l-1.601-4.905-.495-1.647zm24.577 5.776q0 2.64-.99 4.614-.979 1.961-2.787 3.003-1.796 1.042-4.122 1.042h-6.564V22.313h5.873q4.099.0 6.345 2.18 2.245 2.167 2.245 6.224m-3.42.0q0-2.748-1.359-4.19-1.359-1.453-3.881-1.453h-2.407v11.54h2.879q2.188.0 3.478-1.586t1.29-4.311m6 8.659V22.313h12.759v2.761h-9.362v4.287h8.66v2.761h-8.66v4.492h9.835v2.761zm15.75.0v-3.693h3.328v3.693zm12.445-12.149q2.082.0 3.662.781 1.58.78 2.422 2.235.833 1.454.833 3.393.0 2.98-1.845 4.676Q124.302 40 121.085 40q-3.208.0-5.005-1.688-1.798-1.688-1.798-4.695c0-3.007.606-3.57 1.817-4.694q1.817-1.696 4.986-1.696m0 2.702q-2.157.0-3.378.97-1.23.97-1.23 2.72.0 1.777 1.22 2.747 1.211.97 3.388.97 2.195.0 3.462-.988 1.258-.997 1.258-2.711.0-1.778-1.23-2.738-1.23-.97-3.491-.97m6.725-13.402-5.062 2.935v3.107h5.062v2.648h-13.331v-6.322q0-2.261 1.031-3.491 1.022-1.23 2.942-1.23 1.4.0 2.422.754 1.012.754 1.334 2.038l5.601-3.42zm-9.244.314q-1.92.0-1.921 2.334v3.393h3.936v-3.465q0-1.113-.53-1.688t-1.486-.575m7.249-10.915a6.5 6.5.0 00-.313-2.002q-.321-.969-.814-1.499h-1.845v3.088h-2.063V0h4.901q1.088 1.005 1.703 2.622a9.4 9.4.0 01.615 3.375q0 3.088-1.798 4.748-1.808 1.661-5.119 1.661-3.292.0-5.043-1.67-1.76-1.67-1.76-4.803.0-4.452 3.473-5.664l.776 2.442q-1.012.395-1.533 1.238-.52.844-.52 1.984.0 1.867 1.192 2.837t3.416.97q2.261.0 3.501-.997 1.23-1.005 1.23-2.818z"/></svg></abbr></a></div></main><footer id=site-footer class="section-inner thin animated fadeIn faster"><p>&copy; 2026 <a href=https://chiehting.com/>Chiehting's Blog</a>
&#183; Copyright © 2025 Chiehting Lee. All rights reserved.</p></footer><script async src=https://chiehting.com/js/bundle.min.217d62397cbef6f9f5d8bab30d7e7969d78c52a436ca5d5790cef4d6fef3f1f2.js integrity="sha256-IX1iOXy+9vn12LqzDX55adeMUqQ2yl1XkM701v7z8fI=" crossorigin=anonymous></script><script async src=https://chiehting.com/js/link-share.min.24409a4f6e5537d70ffc55ec8f9192208d718678cb8638585342423020b37f39.js integrity="sha256-JECaT25VN9cP/FXsj5GSII1xhnjLhjhYU0JCMCCzfzk=" crossorigin=anonymous></script></body></html>